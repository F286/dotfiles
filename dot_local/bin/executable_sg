#!/usr/bin/env bash
# Ripgrep (safe-by-default): no hidden, respect .gitignore
# Usage: sg [PATTERN] [PATH...] [-H|--hidden] [-I|--ignored] [-- RG_FLAGS...]
set -euo pipefail

hidden=
ignored=
args=()

while [[ $# -gt 0 ]]; do
  case "$1" in
    -H|--hidden)  hidden="--hidden" ;;
    -I|--ignored) ignored="--no-ignore --no-ignore-vcs" ;;
    *)            args+=("$1") ;;
  esac
  shift
done

# Smart-case, line numbers, no headings; user-supplied args go last to allow overrides.
exec rg --smart-case --line-number --no-heading --color never \
  ${hidden:+$hidden} ${ignored:+$ignored} "${args[@]}"
