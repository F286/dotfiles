#!/usr/bin/env bash
set -euo pipefail

# Restart the AltTab app on macOS to reload preferences.

if [ "$(uname -s)" != "Darwin" ]; then
  echo "AltTab restart is macOS-only." >&2
  exit 1
fi

is_installed=false
if [ -d "/Applications/AltTab.app" ] || [ -d "$HOME/Applications/AltTab.app" ]; then
  is_installed=true
elif pgrep -x AltTab >/dev/null 2>&1; then
  is_installed=true
fi

if [ "$is_installed" != "true" ]; then
  echo "AltTab not found. Install with: brew install --cask alt-tab" >&2
  exit 1
fi

# Stop if running (ignore errors if not running)
pkill -x AltTab >/dev/null 2>&1 || killall AltTab >/dev/null 2>&1 || true

# Touch preferences cache (harmless)
defaults read com.lwouis.alt-tab-macos >/dev/null 2>&1 || true

# Relaunch
open -ga AltTab || open -a AltTab

exit 0

