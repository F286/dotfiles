{{ if ne .chezmoi.os "windows" -}}
#!/usr/bin/env bash
set -e

# Install JetBrainsMono Nerd Font if not already installed
if fc-list | grep -qi "JetBrainsMono Nerd Font"; then
    exit 0
fi

if command -v brew >/dev/null 2>&1; then
    brew tap homebrew/cask-fonts
    brew install --cask font-jetbrains-mono-nerd-font
elif command -v apt-get >/dev/null 2>&1; then
    sudo apt-get update
    sudo apt-get install -y unzip curl
    FONT_DIR="$HOME/.local/share/fonts"
    mkdir -p "$FONT_DIR"
    curl -fLo /tmp/JetBrainsMono.zip https://github.com/ryanoasis/nerd-fonts/releases/latest/download/JetBrainsMono.zip
    unzip -o /tmp/JetBrainsMono.zip -d "$FONT_DIR"
    fc-cache -f
elif command -v pacman >/dev/null 2>&1; then
    sudo pacman --noconfirm -S nerd-fonts-jetbrains-mono || true
elif command -v dnf >/dev/null 2>&1; then
    sudo dnf install -y jetbrains-mono-nerd-fonts || true
else
    echo "No supported package manager found for JetBrainsMono Nerd Font installation."
fi

# Configure macOS Terminal to use JetBrainsMono Nerd Font
if [ "{{ .chezmoi.os }}" = "darwin" ]; then
    osascript <<'AS'
    tell application "Terminal"
        set font name of settings set "Basic" to "JetBrainsMono Nerd Font"
        set font size of settings set "Basic" to 13
        set default settings to settings set "Basic"
        set startup settings to settings set "Basic"
    end tell
AS
fi
{{ end -}}

