# Requires PowerShell 7+
$COMMON_APPS = @(
{{- range (split (include "common_apps.txt") "\n") }}
{{- if . | trim }}'{{ . }}'{{ end }}
{{- end }}
)

Write-Host 'Running Windows setup using Scoop...'
if (!(Get-Command scoop -ErrorAction SilentlyContinue)) {
    iwr -useb get.scoop.sh | iex
}
scoop bucket add extras | Out-Null
scoop bucket add nerd-fonts | Out-Null
foreach ($pkg in $COMMON_APPS) {
    scoop install $pkg
}
# Install fonts (Windows-specific: FiraCode-NF)
if (Get-Command Get-FileHash -ErrorAction SilentlyContinue) {
    try {
        scoop install FiraCode-NF
    } catch {
        Write-Warning "Failed to install FiraCode-NF: $_"
    }
} else {
    Write-Warning "Get-FileHash cmdlet not found. Skipping FiraCode-NF install."
}
